angular.module("XXXXXX",["ui.bootstrap","firebaseHelper"]).run(function(){FastClick.attach(document.body),viewportUnitsBuggyfill.init(),Array.prototype.unique=function(){for(var n=this.concat(),i=0;i<n.length;++i)for(var e=i+1;e<n.length;++e)n[i]===n[e]&&n.splice(e--,1);return n}}).config(["$firebaseHelperProvider",function(n){n.namespace("mismith")}]).controller("AppCtrl",["$scope","$firebaseHelper","$q",function(n,i){function e(){n.jsonData.$loaded(function(i){i=angular.copy(i),n.nodes=s.nodes(t.root(i)),n.links=t.imports(n.nodes),n.splines=c(n.links)})}n.jsonData=i.array("mismith-info","nodes");var t={root:function(n){function i(n,t){var r,o=e[n];return o||(o=e[n]=t||{name:n,children:[]},n.length&&(o.parent=i(n.substring(0,r=n.lastIndexOf("."))),o.parent.children.push(o))),o}var e={};return n.forEach(function(n){i(n.$id,n)}),e[""]},imports:function(n){var i={},e=[];return n.forEach(function(n){i[n.$id]=n}),n.forEach(function(n){n.links&&n.links.forEach(function(t){e.push({source:i[n.$id],target:i[t]})})}),e}},r=600,o=r,a=o/2,s=d3.layout.cluster().size([360,a-120]).sort(function(n,i){return d3.ascending(n.$id,i.$id)}),c=d3.layout.bundle();n.arc=d3.svg.arc().outerRadius(a-120).innerRadius(0).startAngle(0).endAngle(2*Math.PI),n.line=d3.svg.line.radial().interpolate("bundle").tension(.5).radius(function(n){return n.y}).angle(function(n){return n.x/180*Math.PI}),n.icon=function(n){var i="assets/img/icons/";switch(n.icon){case"icns":i+="icns/"+n.$id+".iconset/icon_128x128@2x.png";break;case"svg":i+="svg/"+n.$id+".svg";break;case"png":i+="png/"+n.$id+".png"}return i},e();var u="links",l=n.linked={};n.link=function(t,r){var o=t.$id;if(l.key&&l.item){var a=function(){r&&r.shiftKey||(delete l.item.$linking,l=n.linked={})};if(o!=l.key){var s=i.object("mismith-info","nodes",l.key);s.$loaded().then(function(){s[u]=s[u]||[];var n=s[u].indexOf(o);0>n?s[u].push(o):s[u].splice(n,1),s.$save().then(e)}).finally(function(){a()})}else a()}else t.$linking=!0,l.key=o,l.item=t}}]);