angular.module("XXXXXX",["ui.bootstrap","firebaseHelper"]).run(function(){FastClick.attach(document.body),viewportUnitsBuggyfill.init(),Array.prototype.unique=function(){for(var n=this.concat(),e=0;e<n.length;++e)for(var i=e+1;i<n.length;++i)n[e]===n[i]&&n.splice(i--,1);return n}}).config(["$firebaseHelperProvider",function(n){n.namespace("mismith-info")}]).controller("AppCtrl",["$scope","$firebaseHelper","$q",function(n,e,i){n.jsonData=e.array("nodes");var t={root:function(n){function e(n,t){var r,o=i[n];return o||(o=i[n]=t||{name:n,children:[]},n.length&&(o.parent=e(n.substring(0,r=n.lastIndexOf("."))),o.parent.children.push(o))),o}var i={};return n.forEach(function(n){e(n.$id,n)}),i[""]},imports:function(n){var e={},i=[];return n.forEach(function(n){e[n.$id]=n}),n.forEach(function(n){n.links&&n.links.forEach(function(t){i.push({source:e[n.$id],target:e[t]})})}),i}},r=600,o=r,a=o/2,s=d3.layout.cluster().size([360,a-120]).sort(function(n,e){return d3.ascending(n.$id,e.$id)}),c=d3.layout.bundle();n.arc=d3.svg.arc().outerRadius(a-120).innerRadius(0).startAngle(0).endAngle(2*Math.PI),n.line=d3.svg.line.radial().interpolate("bundle").tension(.085).radius(function(n){return n.y}).angle(function(n){return n.x/180*Math.PI}),n.icon=function(n){var e="assets/img/icons/";switch(n.icon){case"icns":e+="icns/"+n.$id+".iconset/icon_128x128@2x.png";break;case"svg":e+="svg/"+n.$id+".svg";break;case"png":e+="png/"+n.$id+".png"}return e},n.jsonData.$loaded(function(e){e=angular.copy(e),n.nodes=s.nodes(t.root(e)),n.links=t.imports(n.nodes),n.splines=c(n.links)});var l="links",u=n.linked={};n.link=function(t,r){var o=t.$id;if(u.key&&u.item){var a=function(){r&&r.shiftKey||(delete u.item.$linked,u=n.linked={})};if(o!=u.key){var s=e.object("nodes",u.key),c=e.object("nodes",o);i.all([s.$loaded(),c.$loaded()]).then(function(){s[l]=s[l]||[];var n=s[l].indexOf(o);0>n?s[l].push(o):s[l].splice(n,1),c[l]=c[l]||[],n=c[l].indexOf(u.key),0>n?c[l].push(u.key):c[l].splice(n,1),s.$save(),c.$save()}).finally(function(){a()})}else a()}else t.$linked=!0,u.key=o,u.item=t}}]);