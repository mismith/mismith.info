angular.module("XXXXXX",["ui.bootstrap","firebaseHelper"]).run(function(){FastClick.attach(document.body),viewportUnitsBuggyfill.init(),Array.prototype.unique=function(){for(var t=this.concat(),n=0;n<t.length;++n)for(var e=n+1;e<t.length;++e)t[n]===t[e]&&t.splice(e--,1);return t}}).config(["$firebaseHelperProvider",function(t){t.namespace("mismith-info")}]).controller("AppCtrl",["$scope","$firebaseHelper",function(t,n){t.jsonData=n.array("nodes");var e={root:function(t){function n(t,r){var i,a=e[t];return a||(a=e[t]=r||{name:t,children:[]},t.length&&(a.parent=n(t.substring(0,i=t.lastIndexOf("."))),a.parent.children.push(a))),a}var e={};return t.forEach(function(t){n(t.$id,t)}),e[""]},imports:function(t){var n={},e=[];return t.forEach(function(t){n[t.$id]=t}),t.forEach(function(t){t.links&&t.links.forEach(function(r){e.push({source:n[t.$id],target:n[r]})})}),e}},r=1280,i=800,a=r/2,s=i/2,o=d3.layout.cluster().size([360,s-120]).sort(function(t,n){return d3.ascending(t.$id,n.$id)}),c=d3.layout.bundle(),l=t.line=d3.svg.line.radial().interpolate("bundle").tension(.085).radius(function(t){return t.y}).angle(function(t){return t.x/180*Math.PI}),u=d3.select("body").append("div").style("top","0").style("left","1000px").style("width",r+"px").style("height",r+"px").style("position","absolute").style("-webkit-backface-visibility","hidden"),d=u.append("svg:svg").attr("width",r).attr("height",r).append("svg:g").attr("transform","translate("+a+","+s+")");d.append("svg:path").attr("class","arc").attr("d",d3.svg.arc().outerRadius(s-120).innerRadius(0).startAngle(0).endAngle(2*Math.PI)),t.icon=function(t){var n="assets/img/icons/";switch(t.icon){case"icns":n+="icns/"+t.$id+".iconset/icon_128x128@2x.png";break;case"svg":n+="svg/"+t.$id+".svg";break;case"png":n+="png/"+t.$id+".png"}return n},t.jsonData.$loaded(function(n){n=angular.copy(n);var r=t.nodes=o.nodes(e.root(n)),i=t.links=e.imports(r),a=t.splines=c(i),s=(d.selectAll("path.link").data(i).enter().append("svg:path").attr("class",function(t){return"link source-"+t.source.$id+" target-"+t.target.$id}).attr("d",function(t,n){return l(a[n])}),d.selectAll("g.node").data(r.filter(function(t){return!t.children})).enter().append("svg:g").attr("class","node").attr("id",function(t){return"node-"+t.$id}).attr("transform",function(t){return"rotate("+(t.x-90)+") translate("+t.y+")"}));s.append("svg:image").attr("width",32).attr("height",32).attr("y",-16).attr("transform",function(t){return t.x<180?null:"rotate(180, 16, 0)"}).attr("xlink:href",function(t){var n="assets/img/icons/";switch(t.icon){case"icns":n+="icns/"+t.$id+".iconset/icon_128x128@2x.png";break;case"svg":n+="svg/"+t.$id+".svg";break;case"png":n+="png/"+t.$id+".png"}return n}),s.append("svg:text").attr("dx",function(t){return t.x<180?40:-40}).attr("dy",4).attr("text-anchor",function(t){return t.x<180?"start":"end"}).attr("transform",function(t){return t.x<180?null:"rotate(180)"}).text(function(t){return t.name})});var f="children",p=t.linked={};t.link=function(n,e,r){if(p.key&&p.item){if(n!=p.key){e[f]=e[f]||[];var i=e[f].indexOf(p.key);0>i?e[f].push(p.key):e[f].splice(i,1),p.item[f]=p.item[f]||[],i=p.item[f].indexOf(n),0>i?p.item[f].push(n):p.item[f].splice(i,1)}r&&r.shiftKey||(delete p.item.$linked,p=t.linked={})}else e.$linked=!0,p.key=n,p.item=e},t.linkedKeys=function(n,e){e=e||1;var r=[];e>1?angular.forEach(t.jsonData[n][f],function(n){r=r.concat(t.linkedKeys(n,e-1))}):r=r.concat(t.jsonData[n][f]);for(var i=0;i<r.length;++i)for(var a=i+1;a<r.length;++a)r[i]===r[a]&&r.splice(a--,1);var s=r.indexOf(n);return s>=0&&r.splice(s,1),r},t.isLinked=function(n,e){return p.key?t.linkedKeys(p.key,e).indexOf(n)>=0:!1}}]);