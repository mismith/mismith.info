angular.module("XXXXXX",["ui.bootstrap","firebaseHelper"]).run(function(){FastClick.attach(document.body),viewportUnitsBuggyfill.init(),Array.prototype.unique=function(){for(var n=this.concat(),e=0;e<n.length;++e)for(var t=e+1;t<n.length;++t)n[e]===n[t]&&n.splice(t--,1);return n}}).config(["$sceProvider","$firebaseHelperProvider",function(n,e){n.enabled(!1),e.namespace("mismith-info")}]).controller("AppCtrl",["$scope","$firebaseHelper","$sce",function(n,e){function t(){n.jsonData.$loaded(function(e){e=angular.copy(e),n.nodes=s.nodes(i.root(e)),n.links=i.imports(n.nodes),n.splines=u(n.links)})}n.auth=e.auth(),n.auth.$onAuth(function(e){e?(n.authed=e,console.log("login",e)):(n.authed=null,console.log("logout"))}),n.jsonData=e.array("nodes");var i={root:function(n){function e(n,i){var o,r=t[n];return r||(r=t[n]=i||{name:n,children:[]},n.length&&(r.parent=e(n.substring(0,o=n.lastIndexOf("."))),r.parent.children.push(r))),r}var t={};return n.forEach(function(n){e(n.$id,n)}),t[""]},imports:function(n){var e={},t=[];return n.forEach(function(n){e[n.$id]=n}),n.forEach(function(n){n.links&&n.links.forEach(function(i){t.push({source:e[n.$id],target:e[i]})})}),t}},o=800,r=o,a=r/2,s=d3.layout.cluster().size([360,a-120]).sort(function(n,e){return d3.ascending(n.name.toLowerCase(),e.name.toLowerCase())}),u=d3.layout.bundle();n.arc=d3.svg.arc().outerRadius(a-120).innerRadius(0).startAngle(0).endAngle(2*Math.PI),n.line=d3.svg.line.radial().interpolate("bundle").tension(.5).radius(function(n){return n.y}).angle(function(n){return n.x/180*Math.PI}),n.icon=function(n){var e="assets/img/icons/";switch(n.icon){case"icns":e+="icns/"+n.$id+".iconset/icon_128x128@2x.png";break;case"svg":e+="svg/"+n.$id+".svg";break;case"png":e+="png/"+n.$id+".png"}return e},n.url=function(n){return n.url},t();var c="links",l=n.linked={};n.link=function(n,i){var o=n.$id;if(l.key&&l.item){var r=function(){i&&i.shiftKey||(delete l.item.$linking,l.key=l.item=null)};if(o!=l.key){var a=e.object("nodes",l.key);a.$loaded().then(function(){a[c]=a[c]||[];var n=a[c].indexOf(o);0>n?a[c].push(o):a[c].splice(n,1),a.$save().then(t).catch(function(n){alert(n.code)})}).finally(function(){r()})}else r()}else n.$linking=!0,l.key=o,l.item=n}}]);